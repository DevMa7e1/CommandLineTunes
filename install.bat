@echo off
powershell -c "Invoke-WebRequest 'https://github.com/DevMa7e1/CommandLineTunes/releases/download/v1.0.0/CLTunes.Windows-x86_64.exe' -OutFile .\cltunes.exe"
mkdir "C:\Program Files\CLTunes"
move cltunes.exe "C:\Program Files\CLTunes"
powershell -c "try {$key = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey('Environment', $true);$oldPath = $key.GetValue('Path', '', 'DoNotExpandEnvironmentNames').TrimEnd([IO.Path]::PathSeparator);$newPath = '{0}{1}{2}' -f $oldPath, [IO.Path]::PathSeparator, 'C:\Program Files\CLTunes';$key.SetValue('Path', $newPath, 'ExpandString')} finally {if ($null -ne $key) {$key.Dispose()}}"
powershell -c "try {$key = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey('SYSTEM\CurrentControlSet\Control\Session Manager\Environment', $true);$oldPath = $key.GetValue('Path', '', 'DoNotExpandEnvironmentNames').TrimEnd([IO.Path]::PathSeparator);$newPath = '{0}{1}{2}' -f $oldPath, [IO.Path]::PathSeparator, 'C:\Program Files\CLTunes';$key.SetValue('Path', $newPath, 'ExpandString')} finally {if ($null -ne $key) {$key.Dispose()}}"
echo CommandLineTunes was succesfully installed! Because Windows takes a while to catch on that you've just installed something new, you need to restart before trying to run CommandLineTunes.